<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="http://pslmodels.org/imgs/PolicySimLibrary-1000px.png"/><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Demo Day: Unit testing for open source projects | PSL blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Demo Day: Unit testing for open source projects" />
<meta name="author" content="Jason DeBacker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to ensure that individual functions do what you expect." />
<meta property="og:description" content="How to ensure that individual functions do what you expect." />
<link rel="canonical" href="https://blog.pslmodels.org/demo-day-unit-testing" />
<meta property="og:url" content="https://blog.pslmodels.org/demo-day-unit-testing" />
<meta property="og:site_name" content="PSL blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-09T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://blog.pslmodels.org/demo-day-unit-testing","headline":"Demo Day: Unit testing for open source projects","dateModified":"2021-08-09T00:00:00-05:00","datePublished":"2021-08-09T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.pslmodels.org/demo-day-unit-testing"},"author":{"@type":"Person","name":"Jason DeBacker"},"description":"How to ensure that individual functions do what you expect.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.pslmodels.org/feed.xml" title="PSL blog" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">PSL blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Demo Day: Unit testing for open source projects</h1><p class="page-description">How to ensure that individual functions do what you expect.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-08-09T00:00:00-05:00" itemprop="datePublished">
        Aug 9, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Jason DeBacker</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#demo-days">demo-days</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#R">R</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#unit-testing">unit-testing</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
</ul>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/LkNEfbKHM5E" frameborder="0" allowfullscreen=""></iframe>
</center>

<hr>

<p>Unit testing is the testing of individual units or functions of a software application.
This differs from regression testing that focuses on the verification of final outputs.
Instead, unit testing tests each smallest testable component of your code.
This helps to more easily identify and trace errors in the code.</p>

<p>Writing unit tests is good practice, though not one that’s always followed.
The biggest barrier to writing unit tests is that doing so takes time.
You might wonder “why am I testing code that runs?”
But there are a number benefits to writing unit tests:</p>
<ul>
  <li>It ensures that the code does what you expect it to do</li>
  <li>You’ll better understand what your code is doing</li>
  <li>You will reduce time tracking down bugs in your code</li>
</ul>

<p>Often, writing unit tests will save you time in the longer run because it reduces debugging time and because it forces you to think more about what your code does, which often leads to the development of more efficient code.
And for open source projects, or projects with many contributors, writing unit tests is important in reducing the likelihood that errors are introduced into your code.
This is why the <a href="https://pslmodels.org/Catalog/library_criteria.html">PSL catalog criteria</a> requires projects to provide at least some level of unit testing.</p>

<p>In the PSL Demo Day video linked above, I illustrate how to implement unit tests in R using the <a href="https://testthat.r-lib.org"> <code class="language-plaintext highlighter-rouge">testthat</code> </a> package.  There are essentially three steps to this process:</p>
<ol>
  <li>Create a directory to put your testing script in, e.g., a folder called <code class="language-plaintext highlighter-rouge">tests</code>
</li>
  <li>Create one or more scripts that define your tests.
    <ul>
      <li>Each test is represented as a call of the <code class="language-plaintext highlighter-rouge">test_that</code> function and contain an statement that will evaluate as true or false (e.g., you may use the <code class="language-plaintext highlighter-rouge">expect_equal</code> function to verify that a function returns expected values given certain inputs).</li>
      <li>You will want to use <code class="language-plaintext highlighter-rouge">test</code> in the name of these tests scripts as well as something descriptive of what is tested.</li>
    </ul>
  </li>
  <li>Create a script that will run your tests.
    <ul>
      <li>Here you’ll need to import the <code class="language-plaintext highlighter-rouge">testthat</code> package and you’ll need to call the script(s) you are testing to load their functions.</li>
      <li>Then you’ll use the <code class="language-plaintext highlighter-rouge">test_dir</code> function to pass the directory in which the script(s) you created in Step 2 reside.</li>
    </ul>
  </li>
</ol>

<p>Check out the video to see examples of how each of these steps is executed.
I’ve also found <a href="https://towardsdatascience.com/unit-testing-in-r-68ab9cc8d211">this blog post</a> on unit tests with <code class="language-plaintext highlighter-rouge">testthat</code> to be helpful.</p>

<p>Unit testing in Python seems to be more developed and straightforward with the excellent <a href="https://docs.pytest.org/en/6.2.x/"> <code class="language-plaintext highlighter-rouge">pytest</code> </a> package.
While <code class="language-plaintext highlighter-rouge">pytest</code> offers many options for parameterizing tests, running tests in parallel, and more, the basic steps remain the same as those outlined above:</p>
<ol>
  <li>Create a directory for your test modules (call this folder <code class="language-plaintext highlighter-rouge">tests</code> as <code class="language-plaintext highlighter-rouge">pytest</code> will look for that name).</li>
  <li>Create test modules that define each test
    <ul>
      <li>Tests are defined much like any other function in Python, the but will involve some assertion statement is triggered upon test failure.</li>
      <li>You will want to use <code class="language-plaintext highlighter-rouge">test</code> in the name of these tests modules as well as something descriptive of what is tested.</li>
    </ul>
  </li>
  <li>You won’t need to create a script to run your tests as with <code class="language-plaintext highlighter-rouge">testthat</code>, but you may create a <a href="https://docs.pytest.org/en/6.2.x/customize.html"><code class="language-plaintext highlighter-rouge">pytest.ini</code></a> file to customize your tests options.</li>
</ol>

<p>That’s about it to get started writing unit tests for your code.  PSL cataloged projects provide many excellent examples of a variety of unit tests, so search them for examples to build from.
In a future Demo Day and blog post, we’ll talk about continuous integration testing to help get even more out of you unit tests.</p>

<p>Resources:</p>
<ul>
  <li>
<a href="https://testthat.r-lib.org"><code class="language-plaintext highlighter-rouge">testthat</code></a> package for unit testing in R</li>
  <li>
<a href="https://docs.pytest.org/en/6.2.x/"><code class="language-plaintext highlighter-rouge">pytest</code></a> package for unit testing in Python</li>
  <li><a href="https://pslmodels.org/Catalog/library_criteria.html">PSL catalog criteria</a></li>
  <li><a href="https://github.com/TaxFoundation/capital-cost-recovery/tree/master/tests">Unit tests for the <code class="language-plaintext highlighter-rouge">capital-cost-recovery</code> model</a></li>
</ul>

  </div><a class="u-url" href="/demo-day-unit-testing" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
      <!-- Begin Mailchimp Signup Form -->
      <link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
      <style type="text/css">
        #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
        /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
           We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
      </style>
      <div id="mc_embed_signup">
      <form action="https://policysimulationlibrary.us19.list-manage.com/subscribe/post?u=a5800eed8cadff70bf999bc29&amp;id=8437c6ae2f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <div id="mc_embed_signup_scroll">
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
          <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
          <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_a5800eed8cadff70bf999bc29_8437c6ae2f" tabindex="-1" value=""></div>
          <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
          </div>
      </form>
      </div>

      <!--End mc_embed_signup-->
      </div>
      <div class="footer-col">
        <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/PSLmodels" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/PSLmodels" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>
      </div>
    </div>

  </div>

</footer></body>

</html>

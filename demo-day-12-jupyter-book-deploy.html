<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="http://pslmodels.org/imgs/PolicySimLibrary-1000px.png"/><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Demo Day: Keeping Jupyter Book documentation up to date with GH Actions | PSL blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Demo Day: Keeping Jupyter Book documentation up to date with GH Actions" />
<meta name="author" content="Jason DeBacker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Keeping Jupyter Book documentation up-to-date with GH Actions" />
<meta property="og:description" content="Keeping Jupyter Book documentation up-to-date with GH Actions" />
<link rel="canonical" href="https://blog.pslmodels.org/demo-day-12-jupyter-book-deploy" />
<meta property="og:url" content="https://blog.pslmodels.org/demo-day-12-jupyter-book-deploy" />
<meta property="og:site_name" content="PSL blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-17T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Keeping Jupyter Book documentation up-to-date with GH Actions","url":"https://blog.pslmodels.org/demo-day-12-jupyter-book-deploy","@type":"BlogPosting","headline":"Demo Day: Keeping Jupyter Book documentation up to date with GH Actions","dateModified":"2021-05-17T00:00:00-05:00","datePublished":"2021-05-17T00:00:00-05:00","author":{"@type":"Person","name":"Jason DeBacker"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.pslmodels.org/demo-day-12-jupyter-book-deploy"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.pslmodels.org/feed.xml" title="PSL blog" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">PSL blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Demo Day: Keeping Jupyter Book documentation up to date with GH Actions</h1><p class="page-description">Keeping Jupyter Book documentation up-to-date with GH Actions</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-17T00:00:00-05:00" itemprop="datePublished">
        May 17, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Jason DeBacker</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#demo-days">demo-days</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#jupyter-book">jupyter-book</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#GH-actions">GH-actions</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#documentation">documentation</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
</ul>
<center>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/rEG5vGMkDsg" frameborder="0" allowfullscreen=""></iframe>
</center>

<hr>

<p>Open source projects must maintain clear and up-to-date documentation in order to attract users and contributors.
Because of this, PSL sets minimum standards for documentation among cataloged projects in its <a href="https://pslmodels.org/Catalog/library_criteria.html">model criteria</a>.
A recent innovation in executable books, <a href="https://jupyterbook.org/intro.html">Jupyter Book</a>, has provided an excellent format for model documentation and has been widely adopted by PSL projects (see for example <a href="https://pslmodels.github.io/OG-USA/content/intro/intro.html">OG-USA</a>, <a href="http://taxbrain.pslmodels.org/content/intro.html">Tax-Brain</a>, <a href="https://taxcalc.pslmodels.org">Tax-Calculator</a>).</p>

<p>Jupyter Book allows one to write documents with executable code and text together, as in Jupyter notebooks.
But Jupyter Book pushes this further by allowing documents with multiple sections, better integration of TeX for symbols and equations, BibTex style references and citations, links between sections, and <a href="https://www.sphinx-doc.org/en/master/">Sphinx</a> integration (for auto-built documentation of model APIs from source code).
Importantly for sharing documentation, Jupyter Books can easily be compiled to HTML, PDF, or other formats.
Portions of a Jupyter Book that contain executable code can be downloaded as Jupyter Notebooks or opened in <a href="https://research.google.com/colaboratory/">Google Colab</a> or <a href="https://mybinder.org">binder</a></p>

<p>The <a href="https://jupyterbook.org/intro.html">Jupyter Book</a> documentation is excellent and will help you get started creating your “book” (tip: pay close attention to formatting details, including proper whitespace).
What I do here is outline how you can easily deploy your documentation to the web and keep it up-to-date with your project.</p>

<p>I start from the assumption that you have the source files to build your Jupyter Book checked into the main branch of your project (these maybe <code class="language-plaintext highlighter-rouge">yml</code>, <code class="language-plaintext highlighter-rouge">md</code>, <code class="language-plaintext highlighter-rouge">rst</code>, <code class="language-plaintext highlighter-rouge">ipynb</code> or other files).
For version control purposes and to keep your repo trim, you generally don’t want to check the built documentation files to this branch (tip: consider adding the folder these files will go to (e.g., <code class="language-plaintext highlighter-rouge">/_build</code> to your <code class="language-plaintext highlighter-rouge">.gitignore</code>).
When these files are in place and you can successfully build your book locally, it’s time for the first step.</p>

<p><em>Step 1</em>: Add two GH Actions to your project’s workflow:</p>
<ol>
  <li>An action to check that your documentation files build without an error.
I like to run this on each push to a PR.
The action won’t hang on warnings, but will fail if your Jupyter Book doesn’t build at all.
An example of this action from the OG-USA repo is <a href="https://github.com/PSLmodels/OG-USA/blob/master/.github/workflows/docs_check.yml">here</a>:
```</li>
</ol>

<p>name: Check that docs build
on: [push, pull_request]</p>

<p>jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2 # If you’re using actions/checkout@v2 you must set persist-credentials to false in most cases for the deployment to work correctly.
        with:
          persist-credentials: false</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  - name: Setup Miniconda
    uses: conda-incubator/setup-miniconda@v2
    with:
      activate-environment: ogusa-dev
      environment-file: environment.yml
      python-version: 3.7
      auto-activate-base: false

  - name: Build # Build Jupyter Book
    shell: bash -l {0}
    run: |
      pip install jupyter-book
      pip install sphinxcontrib-bibtex==1.0.0
      pip install -e .
      cd docs
      jb build ./book ``` To use this in your repo, you'll just need to change a few settings such as the name of the environment and perhaps the Python version and path to the book source files. Note that in the above `yml` file `sphinxcontrib-bibtex` is pinned. You maybe able to unpin this, but OG-USA needed this pin for documentation to compile property due to changes in the `jupyter-book` and `sphinxcontrib-bibtex` packages.
</code></pre></div></div>

<ol>
  <li>An action that builds and deploys the Jupyter Book to <a href="https://pages.github.com">GH Pages</a>.
The OG-USA project uses the <a href="https://github.com/JamesIves/github-pages-deploy-action">deploy action from James Ives</a> in <a href="https://github.com/PSLmodels/OG-USA/blob/master/.github/workflows/deploy_docs.yml">this action</a>.
This is something that you will want to run when PRs are merged into your main branch so that the documentation is kept up-to-date with the project.
To modify this action for your repo, you’ll need to change the repo name, the environment name, and potentially the Python version, branch name, and path to the book source files.</li>
</ol>

<p><em>Step 2</em>: Once the action in (2) above is run, your compiled Jupyter Book docs will be pushed to a <code class="language-plaintext highlighter-rouge">gh-pages</code> branch in your repository (the action will create this branch for you if it doesn’t already exist).
At this point, you should be able to see your docs at the url <code class="language-plaintext highlighter-rouge">https://GH_org_name.github.io/Repo_name</code>.
But it probably won’t look very good until you complete this next step.
To have your Jupyter Book render on the web as you see it on your machine, you will want to push and merge an empty file with the name <code class="language-plaintext highlighter-rouge">.nojekyll</code> into your repo’s <code class="language-plaintext highlighter-rouge">gh-pages</code> branch.</p>

<p>That’s it!
With these actions, you’ll be sure that your book continues to compile and a new version will be published to the web with with each merge to your main branch, ensuring that your documentation stays up-to-date.</p>

<p>Some additional tips:</p>
<ul>
  <li>Use <a href="https://www.sphinx-doc.org/en/master/">Sphinx</a> to document your projects API.
By doing so you’ll automate an important part of your project’s documentation – as long as the docstrings are updated when the source code is, the Jupyter Book you are publishing to the web will be kept in sync with no additional work needed.</li>
  <li>You can have your <code class="language-plaintext highlighter-rouge">gh-pages</code>-hosted documentation point to a custom URL.</li>
  <li>Project maintainers should ensure that docs are updated with PRs that are relevant (e.g., if the PR changes an the source code affecting a user interface, then documentation showing example usage should be updated) and help contributors make the necessary changes to the documentation source files.</li>
</ul>

  </div><a class="u-url" href="/demo-day-12-jupyter-book-deploy" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
      <!-- Begin Mailchimp Signup Form -->
      <link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
      <style type="text/css">
        #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
        /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
           We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
      </style>
      <div id="mc_embed_signup">
      <form action="https://policysimulationlibrary.us19.list-manage.com/subscribe/post?u=a5800eed8cadff70bf999bc29&amp;id=8437c6ae2f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <div id="mc_embed_signup_scroll">
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
          <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
          <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_a5800eed8cadff70bf999bc29_8437c6ae2f" tabindex="-1" value=""></div>
          <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
          </div>
      </form>
      </div>

      <!--End mc_embed_signup-->
      </div>
      <div class="footer-col">
        <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/pslmodels" title="pslmodels"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/pslmodels" title="pslmodels"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>
      </div>
    </div>

  </div>

</footer></body>

</html>
